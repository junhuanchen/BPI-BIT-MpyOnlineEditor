var global=this;global.string=new function(){var c=this;this.strip=function d(g){var f=/^\s*([\s\S]*?)\s*$/;return f.exec(g)[1]};this.deentitize=function e(g){var j=/&#(x?)([a-f0-9]{2,});/ig;while(true){var f=j.exec(g);if(!f){break}var i=f[2];var h=10;if(f[1]){h=16}i=String.fromCharCode(parseInt(i,h));g=g.replace(new RegExp(f[0],"g"),i)}g=g.replace(/&gt;/g,">");g=g.replace(/&lt;/g,"<");g=g.replace(/&apos;/g,"'");g=g.replace(/&quot;/g,'"');g=g.replace(/&amp;/g,"&");g=g.replace(/&nbsp;/g,"");g=g.replace(/^<\?xml\s+version\s*=\s*(["'])[^\1]+\1[^?]*\?>/,"");return g};this.encodeBase64=function a(f){return b.encode(f)};var b={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(h){var f="";var p,n,l,o,m,k,j;var g=0;h=b._utf8_encode(h);while(g<h.length){p=h.charCodeAt(g++);n=h.charCodeAt(g++);l=h.charCodeAt(g++);o=p>>2;m=((p&3)<<4)|(n>>4);k=((n&15)<<2)|(l>>6);j=l&63;if(isNaN(n)){k=j=64}else{if(isNaN(l)){j=64}}f=f+b._keyStr.charAt(o)+b._keyStr.charAt(m)+b._keyStr.charAt(k)+b._keyStr.charAt(j)}return f},_utf8_encode:function(g){g=g.replace(/\r\n/g,"\n");var f="";for(var i=0;i<g.length;i++){var h=g.charCodeAt(i);if(h<128){f+=String.fromCharCode(h)}else{if((h>127)&&(h<2048)){f+=String.fromCharCode((h>>6)|192);f+=String.fromCharCode((h&63)|128)}else{f+=String.fromCharCode((h>>12)|224);f+=String.fromCharCode(((h>>6)&63)|128);f+=String.fromCharCode((h&63)|128)}}}return f}}};global.davlib=new function(){var a=this;this.DEBUG=0;this.STATUS_CODES={"100":"Continue","101":"Switching Protocols","102":"Processing","200":"OK","201":"Created","202":"Accepted","203":"None-Authoritive Information","204":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","307":"Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Time-out","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Request Entity Too Large","414":"Request-URI Too Large","415":"Unsupported Media Type","416":"Requested range not satisfiable","417":"Expectation Failed","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Time-out","505":"HTTP Version not supported","507":"Insufficient Storage"};this.DavClient=function(){};this.DavClient.prototype.initialize=function(d,b,e,f,c){this.host=d||location.hostname;this.port=b||location.port||443;this.protocol=(e||location.protocol.substr(0,location.protocol.length-1)||"https");this.username=f||null;this.password=c||null;this.request=null};this.DavClient.prototype.OPTIONS=function(e,c,b){var d=this._getRequest("OPTIONS",e,c,b);d.send("")};this.DavClient.prototype.GET=function(e,c,b){var d=this._getRequest("GET",e,c,b);d.send("")};this.DavClient.prototype.PUT=function(g,e,c,b,f){var d=this._getRequest("PUT",g,c,b);d.setRequestHeader("Content-type","text/xml,charset=UTF-8");if(f){d.setRequestHeader("If","<"+f+">")}d.send(e)};this.DavClient.prototype.PROPFIND=function(f,d,c,g){var e=this._getRequest("PROPFIND",f,d,c);g=g||0;e.setRequestHeader("Depth",g);e.setRequestHeader("Content-type","text/xml; charset=UTF-8");var b='<?xml version="1.0" encoding="UTF-8" ?>'+'<D:propfind xmlns:D="DAV:">'+"<D:allprop />"+"</D:propfind>";e.send(b)};this.DavClient.prototype.DELETE=function(f,c,b,e){var d=this._getRequest("DELETE",f,c,b);if(e){d.setRequestHeader("If","<"+e+">")}d.send("")};this.DavClient.prototype.MKCOL=function(f,c,b,e){var d=this._getRequest("MKCOL",f,c,b);if(e){d.setRequestHeader("If","<"+e+">")}d.send("")};this.DavClient.prototype.COPY=function(h,i,e,d,c,g){var f=this._getRequest("COPY",h,e,d);var b=this._generateUrl(i);f.setRequestHeader("Destination",b);if(c){f.setRequestHeader("Overwrite","F")}if(g){f.setRequestHeader("If","<"+g+">")}f.send("")};this.DavClient.prototype.MOVE=function(h,i,e,d,c,g){var f=this._getRequest("MOVE",h,e,d);var b=this._generateUrl(i);f.setRequestHeader("Destination",b);if(c){f.setRequestHeader("Overwrite","F")}if(g){f.setRequestHeader("If","<"+g+">")}f.send("")};this.DavClient.prototype._getRequest=function(g,f,d,c){var e=a.getXmlHttpRequest();e.onreadystatechange=this._wrapHandler(d,e,c);var b=this._generateUrl(f);e.open(g,b,true);e.setRequestHeader("Authorization",this._createBasicAuth(this.username,this.password));return e};this.DavClient.prototype._wrapHandler=function(e,f,d){var c=this;function b(){this.execute=function(){if(f.readyState==4){var h=f.status.toString();var j=c._parseHeaders(f.getAllResponseHeaders());var i=f.responseText;var g=a.STATUS_CODES[h];e.call(d,h,g,i,j)}}}return(new b().execute)};this.DavClient.prototype._generateUrl=function(c){var b=this.protocol+"://"+this.host;if(this.port){b+=":"+this.port}b+=c;return b};this.DavClient.prototype._createBasicAuth=function(c,d){var b=c+":"+d;var e=string.encodeBase64(b);return"Basic "+e};this.DavClient.prototype._parseHeaders=function(b){var j=b.split("\n");var c={};for(var d=0;d<j.length;d++){var k=string.strip(j[d]);if(!k){continue}var e=k.split(":");var h=string.strip(e.shift());var g=string.strip(e.join(":"));var f=h.toLowerCase();if(c[f]!==undefined){if(!c[f].push){c[f]=[c[f,g]]}else{c[f].push(g)}}else{c[f]=g}}return c};this.getXmlHttpRequest=function(){try{return new XMLHttpRequest()}catch(b){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}alert("Your browser does not support XMLHttpRequest, required for "+"WebDAV access.");throw ("Browser not supported")};this.debug=function(b){if(!a.DEBUG){return}var c=document.createElement("div");var b=document.createTextNode(b);c.appendChild(b);document.getElementsByTagName("body")[0].appendChild(c)}}();